<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servidores | InfraWatch</title>
    <link rel="stylesheet" href="../css/servidores.css">
    <link rel="icon" href="../assets/icon/Logo-InfraWatch.png" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=account_circle" />
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600&display=swap" rel="stylesheet">
    <script src="../js/sessao.js"></script>
    <script src="https://kit.fontawesome.com/d5ea0dfb99.js" crossorigin="anonymous"></script>

    <script src="../js/servidores.js"></script>

</head>

<body onload="getServidores()">
    <header>
        <nav class="navbar">
            <div class="user_div">
                <div class="img"></div>
                <span class="user_name" id="nome_usuario"></span>
            </div>

            <ul><a href="./servidores.html">Monitoramento</a></ul>
            <ul><a href="./suporte.html">Suporte</a></ul>

            <button class="sair" onclick="limparSessao()">Sair</button>
        </nav>
    </header>
    <div class="main-content">
        <div class="container">
            <div class="header">
                <div class="alinhamento-esquerda">
                    <button onclick="modalColaborador()" class="btn-add-servidor">Adicionar</button>
                    <button onclick="modalFiltro()" class="filtro-servidor"><i class="fa-solid fa-filter"></i>Filtro</button>
                    <input class="input" placeholder=" üîç Pesquisar Servidor..." type="search" name="" id="pesquisa-servidor">
                </div>


                <div class="dropdown">
                    <button class="dropdown-status">STATUS ‚ñº</button>
                    <ul class="dropdown-menu">
                        <li><a href="">Total Cr√≠tico: 13</a></li>
                        <li><a href="">Total Alertas: 6</a></li>

                    </ul>
                </div>
            </div>

            <table id="tabela">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nome</th>
                        <th>Inst√¢ncia</th>
                        <th>N√∫cleos</th>
                        <th>Threads</th>
                        <th>Qtd. GPU</th>
                        <th>Temp. GPU</th>
                        <th>Uso GPU</th>
                        <th>Uso CPU</th>
                    </tr>
                </thead>
                <tbody id="corpo-tabela">
                </tbody>
            </table>
        </div>
    </div>
    </div>

</body>

</html>
<script>

    nome_usuario.innerHTML = sessionStorage.NOME_USUARIO;

    const pesquisa = document.querySelector('.pesquisa');
    const linhas = document.querySelectorAll('tbody tr');
    const btnDropdown = document.querySelector('.dropdown-status');
    const menuDropdown = document.querySelector('.dropdown-menu');

    function carregarListagem(){
        document.addEventListener("DOMContentLoaded", function() {
            let idEmpresa = sessionStorage.getItem("ID_EMPRESA");
            console.log("ID da empresa na nova p√°gina:", idEmpresa);

            if (idEmpresa) {
                try {
                    fetch(`http://127.0.0.1:8000/monitoramento/${idEmpresa}`)
                        .then(resposta => {
                            if (!resposta.ok) {
                                console.log("Erro ao buscar os dados.");
                                return;
                            }
                            return resposta.json();
                        })
                        .then(data => {
                            console.log("Dados recebidos do Servidor: ", data);
                        })
                        .catch(error => {
                            console.error("Erro ao obter os dados: ", error);
                        });
                } catch (error) {
                    console.error("Erro ao obter os dados: ", error);
                }
            } else {
                console.log("ID da empresa n√£o encontrado no sessionStorage.");
            }
        });
    }



    btnDropdown.onclick = () => {
        menuDropdown.style.display = menuDropdown.style.display === 'block' ? 'none' : 'block';
    };

    pesquisa.oninput = () => {
        const termo = pesquisa.value.toLowerCase();
        linhas.forEach(linha => {
            const nome = linha.querySelector('td').textContent.toLowerCase();
            linha.style.display = nome.includes(termo) ? '' : 'none';
        });
    };


</script>